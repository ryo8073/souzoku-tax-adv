# 相続税計算ウェブアプリ PRD（Product Requirements Document）

**作成者**: Manus AI  
**作成日**: 2025年6月30日  
**バージョン**: 1.0  

## 1. エグゼクティブサマリー

本プロダクトは、日本の相続税計算を正確かつ簡単に行うことができるウェブアプリケーションです。法定相続人の判定から相続税額の計算、2割加算の適用まで、相続税に関する複雑な計算を自動化し、誰でも間違いなく相続税の計算ができるツールとして開発されます。

現在、相続税の計算は税理士や専門家に依頼することが一般的ですが、基本的な計算については一般の方でも理解し、概算を把握できることが重要です。本アプリケーションは、エクセルベースの計算ロジックをウェブ化することで、より多くの人が相続税計算にアクセスできる環境を提供します。

### 1.1 プロダクトの価値提案

相続は人生において重要な局面であり、相続税の計算は複雑で専門的な知識を要求されます。本アプリケーションは以下の価値を提供します：

**正確性の確保**: 法定相続人の判定ロジックと相続税計算式を正確に実装し、計算ミスを防ぎます。複雑な家族構成においても、システムが自動的に法定相続人を特定し、適切な相続分を計算します。

**アクセシビリティの向上**: インターネットに接続されたデバイスがあれば、いつでもどこでも相続税の計算が可能になります。専門家への相談前の事前検討や、概算把握のためのツールとして活用できます。

**透明性の提供**: 計算過程を可視化し、どのような根拠で税額が算出されているかを明確に示します。これにより、ユーザーは計算結果に対する理解を深めることができます。

**コスト削減**: 基本的な相続税計算については専門家への依頼コストを削減し、より複雑なケースについてのみ専門家のサポートを求めることができるようになります。

### 1.2 対象ユーザー

**プライマリーユーザー**: 相続が発生した、または発生する可能性のある一般個人および家族。相続税の概算を把握したい方、相続対策を検討している方。

**セカンダリーユーザー**: 税理士、司法書士、ファイナンシャルプランナーなどの専門家。顧客への説明ツールや計算の検証ツールとして活用。

**ターシャリーユーザー**: 相続に関する教育を行う機関や講師。相続税計算の仕組みを教育する際の教材として活用。

## 2. プロダクト概要

### 2.1 プロダクトの目的

日本の相続税法に基づいた正確な相続税計算を、専門知識を持たない一般ユーザーでも簡単に実行できるウェブアプリケーションを提供することです。特に、法定相続人の判定、基礎控除の計算、相続税額の算出、2割加算の適用という一連の計算プロセスを自動化し、透明性の高い計算結果を提供します。

### 2.2 プロダクトの範囲

本アプリケーションは以下の機能を含みます：

**相続財産の入力機能**: ユーザーが相続財産の総額を入力できるインターフェースを提供します。不動産、預貯金、有価証券、その他の財産を分類して入力することも可能とします。

**家族構成の入力機能**: 被相続人との関係性を明確にするため、配偶者の有無、子供の数、養子の数、親の存命状況、兄弟姉妹の数などを入力できる機能を提供します。

**法定相続人判定機能**: 入力された家族構成に基づいて、民法に定められた法定相続人を自動的に判定します。配偶者と血族相続人の組み合わせを正確に識別し、法定相続分を計算します。

**基礎控除計算機能**: 法定相続人の数に基づいて基礎控除額（3,000万円 + 600万円 × 法定相続人数）を自動計算します。

**相続税額計算機能**: 相続税の速算表を用いて、各法定相続人の法定相続分に応じた相続税額を計算し、相続税の総額を算出します。

**2割加算適用機能**: 相続人が被相続人の配偶者、父母、子供以外の場合に適用される2割加算を自動的に判定し、適用します。

**実際の分割による税額配分機能**: 法定相続分とは異なる実際の遺産分割がある場合の税額配分を計算します。

**結果表示機能**: 計算結果を分かりやすく表示し、計算過程も併せて示すことで透明性を確保します。

### 2.3 プロダクトの制約

本アプリケーションは以下の制約があります：

**法的助言の提供不可**: 本アプリケーションは計算ツールであり、法的助言や税務相談は提供しません。複雑なケースについては専門家への相談を推奨します。

**特殊ケースの対応限界**: 非常に複雑な家族構成や特殊な財産形態については、簡易計算の範囲を超える場合があります。

**法改正への対応**: 相続税法の改正があった場合、アプリケーションの更新が必要になります。

**計算結果の保証**: 計算結果は参考値であり、実際の税務申告においては税理士等の専門家による確認を推奨します。



## 3. 機能要件

### 3.1 コア機能

#### 3.1.1 相続財産入力機能

**概要**: ユーザーが相続財産の詳細を入力できる機能です。

**詳細仕様**:
- 課税価格の合計額を数値入力できるフィールドを提供
- 入力値の妥当性チェック（負の値、非数値の排除）
- 千円単位での入力を基本とし、自動的に円単位に変換
- 入力値のリアルタイム表示と確認機能
- 入力内容のクリア機能

**入力項目**:
- 課税価格の合計額（必須）
- 備考欄（任意）

#### 3.1.2 家族構成入力機能

**概要**: 被相続人の家族構成を詳細に入力し、法定相続人の判定に必要な情報を収集する機能です。

**詳細仕様**:

**配偶者情報**:
- 配偶者の有無（ラジオボタン：有/無）
- 配偶者が存命の場合の確認

**子供情報**:
- 子供の総数（数値入力、0以上の整数）
- 養子の数（数値入力、実子との区別）
- 養子縁組の制限ルール適用（実子がいる場合は養子1人まで、実子がいない場合は養子2人まで法定相続人として計算）

**直系尊属情報**:
- 父母の生存状況（選択肢：両方存命/父のみ存命/母のみ存命/両方死亡）
- 祖父母の生存状況（父母が死亡している場合のみ表示）

**兄弟姉妹情報**:
- 兄弟姉妹の数（数値入力、0以上の整数）
- 半血兄弟姉妹の区別（全血/半血の選択）

**法定相続人以外の相続人情報**:
- 遺言による相続人の数（数値入力）
- 遺贈を受ける人の数（数値入力）

#### 3.1.3 法定相続人判定機能

**概要**: 入力された家族構成に基づいて、民法に定められた法定相続人を自動判定する機能です。

**判定ロジック**:

**第一順位**: 子供（直系卑属）
- 子供がいる場合、子供が法定相続人となる
- 子供が死亡している場合は代襲相続により孫が相続人となる
- 養子も実子と同様に扱うが、法定相続人数の計算では制限あり

**第二順位**: 直系尊属（父母、祖父母等）
- 子供がいない場合に限り、直系尊属が法定相続人となる
- 父母が存命の場合は父母が相続人
- 父母が死亡し祖父母が存命の場合は祖父母が相続人

**第三順位**: 兄弟姉妹
- 子供も直系尊属もいない場合に限り、兄弟姉妹が法定相続人となる
- 兄弟姉妹が死亡している場合は代襲相続により甥姪が相続人となる（一代限り）

**配偶者**: 常に相続人（他の相続人と併存）
- 配偶者は常に法定相続人となる
- 他の血族相続人の順位に関わらず相続権を有する

**法定相続分の計算**:
- 配偶者と子供：配偶者1/2、子供1/2（子供が複数の場合は等分）
- 配偶者と直系尊属：配偶者2/3、直系尊属1/3（複数の場合は等分）
- 配偶者と兄弟姉妹：配偶者3/4、兄弟姉妹1/4（複数の場合は等分、半血は全血の1/2）
- 配偶者のみ：配偶者が全部相続

#### 3.1.4 基礎控除計算機能

**概要**: 法定相続人の数に基づいて基礎控除額を自動計算する機能です。

**計算式**: 基礎控除額 = 3,000万円 + 600万円 × 法定相続人の数

**詳細仕様**:
- 法定相続人数の自動カウント
- 養子の法定相続人数制限の適用
- 基礎控除額の自動計算と表示
- 課税価格との比較表示

#### 3.1.5 相続税額計算機能

**概要**: 相続税の速算表を用いて相続税の総額を計算する機能です。

**計算プロセス**:
1. 課税遺産総額の計算（課税価格の合計額 - 基礎控除額）
2. 各法定相続人の法定相続分の計算
3. 各法定相続人の法定相続分に応じた取得金額の算出
4. 速算表による各相続人の税額計算
5. 相続税の総額の算出（各相続人の税額の合計）

**相続税速算表**:
| 法定相続分に応じる取得金額 | 税率 | 控除額 |
|---------------------------|------|--------|
| 1,000万円以下 | 10% | - |
| 3,000万円以下 | 15% | 50万円 |
| 5,000万円以下 | 20% | 200万円 |
| 1億円以下 | 30% | 700万円 |
| 2億円以下 | 40% | 1,700万円 |
| 3億円以下 | 45% | 2,700万円 |
| 6億円以下 | 50% | 4,200万円 |
| 6億円超 | 55% | 7,200万円 |

#### 3.1.6 2割加算適用機能

**概要**: 相続人が被相続人の配偶者、父母、子供以外の場合に適用される2割加算を自動判定・適用する機能です。

**適用対象者**:
- 兄弟姉妹
- 甥姪（代襲相続人）
- 祖父母（直系尊属だが父母以外）
- 法定相続人以外の受遺者

**適用除外者**:
- 配偶者
- 子供（実子・養子問わず）
- 孫（子の代襲相続人）
- 父母

**計算方法**:
各相続人の相続税額 × 1.2（20%加算）

#### 3.1.7 実際の分割による税額配分機能

**概要**: 法定相続分と異なる実際の遺産分割がある場合の税額配分を計算する機能です。

**機能詳細**:
- **分割方式の選択**: 金額指定と割合指定の2つの方式を切り替え可能
  - 金額指定方式：各相続人の実際の取得金額を直接入力
  - 割合指定方式：各相続人の取得割合（％）を入力し、自動的に金額を計算
- **金額指定方式**:
  - 各相続人の実際の取得金額を数値入力
  - 入力金額の合計が課税価格の合計額と一致するかの検証
  - 差額がある場合の警告表示と調整機能
- **割合指定方式**:
  - 各相続人の取得割合を％で入力（小数点以下2桁まで対応）
  - 割合の合計が100％になるかの自動検証
  - 割合から金額への自動変換表示
  - 端数処理の明示（四捨五入、切り上げ、切り捨ての選択）
- **方式間の切り替え**:
  - ラジオボタンまたはタブによる直感的な切り替えUI
  - 切り替え時のデータ保持と自動変換
  - 変換時の端数処理に関する注意喚起
- 相続税の総額を実際の取得割合で按分
- 2割加算の適用
- 各種控除の適用（配偶者控除、未成年者控除等）

### 3.2 補助機能

#### 3.2.1 入力支援機能

**概要**: ユーザーの入力を支援し、エラーを防ぐ機能です。

**機能詳細**:
- 入力値の妥当性チェック
- 必須項目の入力確認
- 入力内容の自動保存（ブラウザローカルストレージ）
- 入力内容のリセット機能
- 入力ガイダンスの表示

#### 3.2.2 計算結果表示機能

**概要**: 計算結果を分かりやすく表示する機能です。

**表示内容**:
- 法定相続人の一覧と続柄
- 各相続人の法定相続分
- 基礎控除額
- 課税遺産総額
- 相続税の総額
- 各相続人の相続税額（2割加算適用後）
- 実際の分割による税額配分

**表示形式**:
- 表形式での一覧表示
- グラフィカルな家系図表示
- 計算過程の詳細表示
- PDF出力機能

#### 3.2.3 ヘルプ・ガイダンス機能

**概要**: ユーザーが迷わず操作できるよう支援する機能です。

**機能詳細**:
- 各入力項目の説明表示
- 相続税制度の基本説明
- よくある質問（FAQ）
- 用語集
- 計算例の提示


## 4. 非機能要件

### 4.1 パフォーマンス要件

**レスポンス時間**: 
- 計算処理は3秒以内に完了する必要があります
- ページの初期読み込みは5秒以内に完了する必要があります
- ユーザーの入力に対するフィードバックは1秒以内に表示される必要があります

**スループット**:
- 同時に100ユーザーまでの利用を想定します
- ピーク時（税務申告期間）には300ユーザーまでの同時アクセスに対応します

**スケーラビリティ**:
- ユーザー数の増加に応じてサーバーリソースを動的に拡張できる設計とします
- データベースの負荷分散に対応した設計とします

### 4.2 可用性要件

**稼働率**: 99.5%以上の稼働率を維持します

**メンテナンス**: 
- 定期メンテナンスは月1回、深夜時間帯（2:00-4:00）に実施します
- 緊急メンテナンスが必要な場合は事前通知を行います

**障害対応**:
- システム障害発生時は4時間以内に復旧します
- データバックアップは日次で実行し、7日間保持します

### 4.3 セキュリティ要件

**データ保護**:
- 個人情報は暗号化して保存します
- HTTPS通信を必須とします
- セッション管理を適切に実装します

**アクセス制御**:
- 不正アクセスの検知と防御機能を実装します
- ブルートフォース攻撃への対策を実装します

**プライバシー**:
- 入力データはユーザーのブラウザローカルストレージに保存し、サーバーには送信しません（計算処理時を除く）
- 個人を特定できる情報の収集は最小限に留めます

### 4.4 ユーザビリティ要件

**操作性**:
- 直感的な操作が可能なユーザーインターフェースを提供します
- モバイルデバイスでも快適に利用できるレスポンシブデザインを採用します
- アクセシビリティガイドライン（WCAG 2.1 AA）に準拠します

**学習容易性**:
- 初回利用時でも迷わず操作できるよう、ガイダンス機能を提供します
- ヘルプドキュメントを充実させ、検索機能を提供します

**エラー処理**:
- エラーメッセージは分かりやすい日本語で表示します
- エラーの原因と対処方法を明確に示します
- 入力エラーは即座に検知し、ユーザーに通知します

### 4.5 互換性要件

**ブラウザ対応**:
- Chrome（最新版および1つ前のメジャーバージョン）
- Firefox（最新版および1つ前のメジャーバージョン）
- Safari（最新版および1つ前のメジャーバージョン）
- Edge（最新版および1つ前のメジャーバージョン）

**デバイス対応**:
- デスクトップPC（Windows、Mac）
- タブレット（iPad、Android）
- スマートフォン（iPhone、Android）

**画面解像度**:
- 最小解像度：320px × 568px（iPhone SE）
- 推奨解像度：1920px × 1080px以上

## 5. ユーザーストーリー

### 5.1 基本的な相続税計算

**ストーリー**: 一般ユーザーとして、父が亡くなった際の相続税を計算したい

**詳細**:
- ユーザーは相続財産の総額を入力します
- 家族構成（配偶者の有無、子供の数等）を入力します
- システムが法定相続人を自動判定します
- 基礎控除額が自動計算されます
- 相続税の総額が計算され、各相続人の負担額が表示されます

**受け入れ基準**:
- 正確な法定相続人の判定ができること
- 相続税の計算結果が法定の計算式に基づいて正確であること
- 計算過程が透明に表示されること

### 5.2 複雑な家族構成での計算

**ストーリー**: 養子がいる複雑な家族構成での相続税計算を行いたい

**詳細**:
- ユーザーは実子と養子の数を区別して入力します
- システムが養子の法定相続人数制限を適用します
- 正確な法定相続人数に基づいて基礎控除額を計算します
- 各相続人の相続分と税額を正確に計算します

**受け入れ基準**:
- 養子の制限ルールが正確に適用されること
- 複雑な家族構成でも正確な計算ができること

### 5.3 2割加算の適用

**ストーリー**: 兄弟姉妹が相続人となる場合の2割加算を含む計算を行いたい

**詳細**:
- ユーザーは被相続人に子供や親がいない状況を入力します
- システムが兄弟姉妹を法定相続人として判定します
- 2割加算が自動的に適用されます
- 加算後の税額が正確に計算されます

**受け入れ基準**:
- 2割加算の適用対象者が正確に判定されること
- 加算後の税額が正確に計算されること

### 5.4 実際の分割での計算

**ストーリー**: 法定相続分とは異なる実際の遺産分割での税額を計算したい

**詳細**:
- ユーザーは分割方式（金額指定/割合指定）を選択します
- 金額指定の場合：各相続人の実際の取得金額を入力します
- 割合指定の場合：各相続人の取得割合（％）を入力します
- システムが相続税の総額を実際の取得割合で按分します
- 各相続人の最終的な納税額を計算します

**受け入れ基準**:
- 金額指定と割合指定の両方式が正確に動作すること
- 方式間の切り替えがスムーズに行えること
- 入力値の検証が適切に行われること
- 実際の分割割合に基づく正確な税額配分ができること
- 各種控除が適切に適用されること

### 5.5 分割方式の切り替え

**ストーリー**: 遺産分割の入力方法を状況に応じて切り替えたい

**詳細**:
- ユーザーは金額での指定と割合での指定を選択できます
- 既に入力したデータがある場合、切り替え時に自動変換されます
- 端数処理の方法を選択できます
- 変換結果を確認してから確定できます

**受け入れ基準**:
- 直感的なUI操作で方式を切り替えられること
- データの自動変換が正確に行われること
- 端数処理のオプションが提供されること
- 変換時の注意事項が適切に表示されること

### 5.6 モバイルでの利用

**ストーリー**: スマートフォンで外出先から相続税の概算を確認したい

**詳細**:
- ユーザーはスマートフォンでアプリにアクセスします
- タッチ操作で快適に入力できます
- 計算結果が見やすく表示されます

**受け入れ基準**:
- モバイルデバイスで快適に操作できること
- 画面サイズに応じて適切にレイアウトが調整されること

## 6. 技術要件

### 6.1 システム構成

**フロントエンド**:
- React.js（最新安定版）
- TypeScript
- Material-UI または Ant Design
- Responsive Web Design

**バックエンド**:
- Flask（Python）
- RESTful API設計
- JSON形式でのデータ交換

**データベース**:
- 基本的にはステートレスな計算のため、永続化は最小限
- 必要に応じてRedis（セッション管理）

**インフラストラクチャ**:
- クラウドベース（AWS、GCP、Azure等）
- Docker コンテナ化
- CI/CD パイプライン

### 6.2 開発環境

**バージョン管理**: Git（GitHub）

**開発ツール**:
- Visual Studio Code
- ESLint、Prettier（コード品質管理）
- Jest（テストフレームワーク）

**デプロイメント**:
- 自動デプロイメント
- ステージング環境での事前テスト
- ブルーグリーンデプロイメント

### 6.3 品質保証

**テスト戦略**:
- 単体テスト（カバレッジ80%以上）
- 統合テスト
- E2Eテスト
- パフォーマンステスト

**コード品質**:
- コードレビューの実施
- 静的解析ツールの活用
- セキュリティスキャンの実施

## 7. プロジェクト計画

### 7.1 開発フェーズ

**フェーズ1**: 要件定義・設計（完了）
- PRD作成
- システム設計
- UI/UX設計

**フェーズ2**: 開発（予定）
- バックエンドAPI開発
- フロントエンド開発
- 単体テスト実装

**フェーズ3**: テスト・品質保証（予定）
- 統合テスト
- ユーザーテスト
- パフォーマンステスト

**フェーズ4**: デプロイ・リリース（予定）
- 本番環境構築
- デプロイメント
- 運用開始

### 7.2 成功指標

**機能的指標**:
- 計算精度100%（既知のテストケースに対して）
- 全ブラウザでの動作確認完了
- モバイル対応完了

**非機能的指標**:
- ページ読み込み時間5秒以内
- 計算処理時間3秒以内
- 稼働率99.5%以上

**ユーザー体験指標**:
- ユーザビリティテストでの満足度80%以上
- エラー発生率5%以下
- ヘルプドキュメントの参照率30%以下（直感的な操作の実現）

## 8. リスクと対策

### 8.1 技術的リスク

**リスク**: 計算ロジックの複雑性による実装ミス
**対策**: 
- エクセルファイルとの詳細な照合テスト
- 税理士による計算結果の検証
- 豊富なテストケースの作成

**リスク**: パフォーマンスの問題
**対策**:
- 早期段階でのパフォーマンステスト実施
- キャッシュ機能の実装
- 計算処理の最適化

### 8.2 法的リスク

**リスク**: 相続税法の改正
**対策**:
- 法改正情報の定期的な確認
- アップデート機能の実装
- 免責事項の明記

**リスク**: 計算結果の誤用
**対策**:
- 免責事項の明確な表示
- 専門家への相談推奨の表示
- 計算結果の参考値である旨の明記

### 8.3 事業リスク

**リスク**: ユーザー獲得の困難
**対策**:
- SEO対策の実施
- 専門家との連携
- 口コミマーケティングの活用

**リスク**: 競合サービスの出現
**対策**:
- 継続的な機能改善
- ユーザーフィードバックの活用
- 差別化要素の強化

---

**文書の終了**

本PRDは相続税計算ウェブアプリケーションの開発における指針となる文書です。開発過程において新たな要件や制約が判明した場合は、本文書を適宜更新し、関係者間での合意を図ります。

